 <html>
   <head>
      <title>Autobahn WebSockets Simple PubSub Demo</title>

      <script src="http://code.jquery.com/jquery-1.6.2.min.js"></script>
      <script src="../../../lib/javascript/autobahn.js"></script>
      <script>

         var sess = null;

         function onEvent(event, d) {
            console.log(event);
            d.then(onEvent);
         }

         $(document).ready(function()
         {
            sess = new ab.Session("ws://localhost:9000", function() {
                                                            console.log("Connected!");
                                                            sess.prefix("event", "http://example.com/event/");
                                                            sess.subscribe("event:simple").then(onEvent);
                                                            sess.subscribe("event:simple-foobar").then(onEvent);
                                                            sess.subscribe("event:foobar1").then(onEvent);
                                                            sess.subscribe("event:foobar2").then(onEvent);
            });

         });

         function logerror(erroruri, errordesc) {
            console.log(erroruri + ' ("' + errordesc + '")');
         }

         function test()
         {
            sess.publish("event:simple", {name: "foo", value: "bar", num: 23});
            sess.publish("event:simple-foobar", {name: "foo", value: "bar", num: 333});
            sess.publish("event:foobar1", {count: 42});
            sess.publish("event:foobar1", {count: -1});
            sess.publish("event:foobar2", {count: 666});
            sess.publish("event:foobarbaz", {count: 10});
         }

     </script>
   </head>
   <body>
      <button onclick="test()">Publish Events</button>
   </body>
 </html>
